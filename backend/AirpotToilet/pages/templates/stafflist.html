{% extends 'base.html' %}

{% block title %}Staff List{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="mb-4">Staff List</h1>
    <!-- <button id="registerstaff" class="btn btn-primary">Register Staff</button> -->
    <table class="table table-striped table-bordered">
        <thead class="thead-dark">
            <tr>
                <th>Sno</th>
                <th>Full Name</th>
                <th>Phone Number</th>
                <th>Address</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="staff-list">
            <!-- Data will be populated here -->
        </tbody>
    </table>
</div>
<script>
    console.log('Script is running');
    
    document.addEventListener('DOMContentLoaded', function () {
        console.log('DOM fully loaded and parsed');
        
        fetch('http://localhost:8000/api/getstaff')
            .then(response => {
                console.log('Response status:', response.status);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('Parsed JSON:', data);

                const staffList = document.getElementById('staff-list');
                staffList.innerHTML = '';

                data.forEach((staff, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${staff.Sname}</td>
                        <td>${staff.Phone}</td>
                        <td>${staff.Address}</td>
                        <td>
                            <button class="btn btn-primary btn-sm">Edit</button>
                            <button class="btn btn-danger btn-sm">Delete</button>
                        </td>
                    `;
                    staffList.appendChild(row);
                });
            })
            .catch(error => console.error('Error fetching staff data:', error));
    });
</script>
{% endblock %}
